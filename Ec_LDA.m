clear;
clc;
format long
A=0.015545;a=0.20548;b1=14.1189;b2=6.1977;b3=3.3662;b4=0.62517;
N=1000;
rm=100;
r=linspace(0,rm,N+1);
x=(3/4*exp(2*r)).^(1/6);
e=-2*A*(1+a*x.^2).*log(1+1./(2*A*(b1*x+b2*x.^2+b3*x.^3+b4*x.^4)));
f=4*r.^2.*exp(-2*r).*e;
E=0;
for j=2:2:N/2
  E=E+rm/N/3.*(f(j-1)+4.*f(j)+f(j+1));
end
%%
y=[-12.814215 -12.836625 -12.854928 -12.869382 -12.880060 -12.887075 -12.890597 -12.890672 -12.887484 -12.881073 -12.871715];
x=[4.09 4.10 4.11 4.12 4.13 4.14 4.15 4.16 4.17 4.18 4.19];
plot(x,y,'-');
xlabel('晶格常数（埃）');
ylabel('总能');
